# ๐ JWT Authentication System

## ะะฐะบ ััะพ ัะฐะฑะพัะฐะตั?

### **1. ะะตะณะธัััะฐัะธั/ะะพะณะธะฝ**

1. ะะพะปัะทะพะฒะฐัะตะปั ะฒะฒะพะดะธั username ะธ password ะฒ `Auth.js`
2. ะคัะพะฝัะตะฝะด ะพัะฟัะฐะฒะปัะตั POST ะทะฐะฟัะพั ะฝะฐ `/api/auth`:
   ```javascript
   {
       "mode": "reg" ะธะปะธ "login",
       "user": "username",
       "pwd": "password"
   }
   ```

3. ะะตะบะตะฝะด ะฟัะพะฒะตััะตั ะฟะฐัะพะปั ัะตัะตะท `shield-auth` (PasswordManager ั bcrypt)
4. ะัะปะธ ััะฟะตัะฝะพ, ะฑะตะบะตะฝะด ะณะตะฝะตัะธััะตั **JWT ัะพะบะตะฝ** ะฝะฐ 7 ะดะฝะตะน:
   ```json
   {
       "status": "success",
       "user": "username",
       "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...."
   }
   ```

### **2. ะกะพััะฐะฝะตะฝะธะต ัะพะบะตะฝะฐ**

1. ะคัะพะฝัะตะฝะด ะฟะพะปััะฐะตั ัะพะบะตะฝ ะธ ัะพััะฐะฝัะตั ะฒ **localStorage**:
   ```javascript
   localStorage.setItem('auth_token', token);
   ```

2. ะะพะปัะทะพะฒะฐัะตะปั ัะพััะฐะฝัะตััั ะฒ `store.js`:
   ```javascript
   store.login(username, token);
   ```

### **3. ะะฐะฟะพะผะธะฝะฐะฝะธะต ะฐะบะบะฐัะฝัะฐ**

ะัะธ ะฟะตัะตะทะฐะณััะทะบะต ัััะฐะฝะธัั ััะพะฝัะตะฝะด ะฒะพัััะฐะฝะฐะฒะปะธะฒะฐะตั ะฟะพะปัะทะพะฒะฐัะตะปั:
```javascript
// store.js
user: localStorage.getItem('auth_user') || null,
token: localStorage.getItem('auth_token') || null,
```

ะะพััะพะผั **ะฝะต ะฝัะถะฝะพ ะปะพะณะธะฝะธัััั ะบะฐะถะดัะน ัะฐะท!** โ

### **4. ะะฐัะธััะฝะฝัะต ะทะฐะฟัะพัั**

ะะพะณะดะฐ ะฝัะถะตะฝ ะดะพัััะฟ ะบ ะทะฐัะธััะฝะฝัะผ ัะตััััะฐะผ (ะฟัะพัะธะปั, ะปะธะดะตัะฑะพัะด):

1. ะคัะพะฝัะตะฝะด ะดะพะฑะฐะฒะปัะตั ัะพะบะตะฝ ะฒ ะทะฐะณะพะปะพะฒะพะบ:
   ```javascript
   headers: {
       'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9....'
   }
   ```

2. ะะตะบะตะฝะด ะฟัะพะฒะตััะตั ัะพะบะตะฝ ะฒ ััะฝะบัะธะธ `verify_token()`:
   ```python
   def verify_token(token):
       payload = jwt.decode(token, SECRET_KEY, algorithms=['HS256'])
       return payload.get('user')
   ```

3. ะัะปะธ ัะพะบะตะฝ ะฒะฐะปะธะดะฝัะน - ะฒะพะทะฒัะฐัะฐะตั ะดะฐะฝะฝัะต, ะตัะปะธ ะฝะตั - ะพัะธะฑะบะฐ 401.

### **5. ะััะพะด (Logout)**

ะะพะณะดะฐ ะฟะพะปัะทะพะฒะฐัะตะปั ะฝะฐะถะธะผะฐะตั "Logout":
```javascript
clearToken();  // ะฃะดะฐะปัะตั ะธะท localStorage
store.logout(); // ะัะธัะฐะตั ะฟะพะปัะทะพะฒะฐัะตะปั ะฒ store
```

---

## ๐ ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          ะคะะะะขะะะ (GitHub Pages)                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                     โ
โ  js/api.js                                          โ
โ  โโ saveToken(token)     โ localStorage             โ
โ  โโ getToken()          โ localStorage              โ
โ  โโ clearToken()        โ ัะดะฐะปัะตั ะธะท localStorage   โ
โ  โโ apiCall()           โ ะดะพะฑะฐะฒะปัะตั Authorization   โ
โ                                                     โ
โ  js/store.js                                        โ
โ  โโ user (username)     โ localStorage              โ
โ  โโ token               โ localStorage              โ
โ  โโ login(user, token)  โ ัะพััะฐะฝัะตั ะพะฑะฐ             โ
โ                                                     โ
โ  js/pages/Auth.js                                   โ
โ  โโ submitAuth()        โ saveToken() + store       โ
โ                                                     โ
โ  js/pages/Profile.js                                โ
โ  โโ fetchProfile()      โ Authorization: Bearer ... โ
โ  โโ logout()            โ clearToken()              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                        โ HTTPS (cloudflared)
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         ะะะะะะ (ะฝะฐ ัะตะปะตัะพะฝะต)                        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                     โ
โ  simple_backend.py                                  โ
โ  โโ SECRET_KEY          โ ัะณะตะฝะตัะธัะพะฒะฐะฝ ะพะดะธะฝ ัะฐะท     โ
โ  โ                                                 โ
โ  โโ /api/auth POST                                 โ
โ  โ  โโ pm.check_user()  โ ะฟัะพะฒะตััะตั ะฟะฐัะพะปั bcrypt โ
โ  โ  โโ jwt.encode()     โ ัะพะทะดะฐัั ัะพะบะตะฝ ะฝะฐ 7 ะดะฝะตะน โ
โ  โ                                                 โ
โ  โโ /api/profile GET                               โ
โ  โ  โโ verify_token()   โ ะฟัะพะฒะตััะตั Authorization  โ
โ  โ  โโ ะฒะพะทะฒัะฐัะฐะตั ะฟัะพัะธะปั ะตัะปะธ ัะพะบะตะฝ ะฒะฐะปะธะดะฝัะน      โ
โ  โ                                                 โ
โ  โโ /api/leaderboard POST/GET                      โ
โ     โโ verify_token() ะตัะปะธ ะฝัะถะฝะฐ ะทะฐัะธัะฐ             โ
โ                                                     โ
โ  shield/core.py (PasswordManager)                   โ
โ  โโ register_user()     โ bcrypt.hashpw()          โ
โ  โโ check_user()        โ bcrypt.checkpw()         โ
โ                                                     โ
โ  accounts.txt                                       โ
โ  โโ username:bcrypt_hash (ะฑะตะทะพะฟะฐัะฝะพ!)              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ะะตะทะพะฟะฐัะฝะพััั

- โ **ะะฐัะพะปะธ ะทะฐัะตัะธัะตะฝั ั bcrypt** (ะฝะต ะฒ ะพัะบัััะพะผ ะฒะธะดะต)
- โ **JWT ัะพะบะตะฝั ะฟะพะดะฟะธัะฐะฝั SECRET_KEY** (ะฝะตะฒะพะทะผะพะถะฝะพ ะฟะพะดะดะตะปะฐัั)
- โ **ะขะพะบะตะฝ ะดะตะนััะฒัะตั 7 ะดะฝะตะน** (ะฟะพัะพะผ ะฝัะถะฝะพ ะปะพะณะธะฝะธัััั ะทะฐะฝะพะฒะพ)
- โ **HTTPS ัะตัะตะท cloudflared** (ัะธััะพะฒะฐะฝะธะต ะฒ ะฟััะธ)
- โ **Authorization ะฒ ะทะฐะณะพะปะพะฒะบะต** (ะฝะต ะฒ URL)

---

## ๐ ะัะพัะตัั

### ะะตะณะธัััะฐัะธั:
```
1. ะะพะปัะทะพะฒะฐัะตะปั ะฒะฒะพะดะธั username + password
2. ะคัะพะฝัะตะฝะด ะพัะฟัะฐะฒะปัะตั POST /api/auth ั mode='reg'
3. ะะตะบะตะฝะด ะฟัะพะฒะตััะตั ััะพ ะฟะพะปัะทะพะฒะฐัะตะปั ะฝะต ัััะตััะฒัะตั
4. ะะตะบะตะฝะด ัะตัะธััะตั ะฟะฐัะพะปั ัะตัะตะท bcrypt
5. ะะตะบะตะฝะด ัะพััะฐะฝัะตั username:hash ะฒ accounts.txt
6. ะะตะบะตะฝะด ัะพะทะดะฐัั JWT ัะพะบะตะฝ
7. ะคัะพะฝัะตะฝะด ัะพััะฐะฝัะตั ัะพะบะตะฝ ะฒ localStorage
8. ะะพะปัะทะพะฒะฐัะตะปั ะฟะตัะตะฝะฐะฟัะฐะฒะปัะตััั ะฝะฐ ะฟัะพัะธะปั
```

### ะะพะณะธะฝ:
```
1. ะะพะปัะทะพะฒะฐัะตะปั ะฒะฒะพะดะธั username + password
2. ะคัะพะฝัะตะฝะด ะพัะฟัะฐะฒะปัะตั POST /api/auth ั mode='login'
3. ะะตะบะตะฝะด ะฝะฐัะพะดะธั ะฟะพะปัะทะพะฒะฐัะตะปั ะฒ accounts.txt
4. ะะตะบะตะฝะด ะฟัะพะฒะตััะตั ะฟะฐัะพะปั ัะตัะตะท bcrypt.checkpw()
5. ะะตะบะตะฝะด ัะพะทะดะฐัั JWT ัะพะบะตะฝ (ะตัะปะธ ะฟะฐัะพะปั ะฒะตัะฝัะน)
6. ะคัะพะฝัะตะฝะด ัะพััะฐะฝัะตั ัะพะบะตะฝ ะฒ localStorage
7. ะะพะปัะทะพะฒะฐัะตะปั ะฟะตัะตะฝะฐะฟัะฐะฒะปัะตััั ะฝะฐ ะฟัะพัะธะปั
```

### ะะฐะฟะพะผะธะฝะฐะฝะธะต ะฐะบะบะฐัะฝัะฐ:
```
1. ะัะธ ะทะฐะณััะทะบะต ัััะฐะฝะธัั store.js ะฟัะพะฒะตััะตั localStorage
2. ะัะปะธ ัะฐะผ ะตััั auth_user ะธ auth_token - ะฟะพะปัะทะพะฒะฐัะตะปั ะทะฐััะป
3. ะคัะพะฝัะตะฝะด ััะฐะทั ะฟะพะบะฐะทัะฒะฐะตั ะฟัะพัะธะปั (ะฑะตะท ะฟะพะฒัะพัะฝะพะณะพ ะปะพะณะธะฝะฐ)
4. ะัะธ ะฝัะถะดะต ะพัะฟัะฐะฒะธัั ะทะฐัะธััะฝะฝัะน ะทะฐะฟัะพั - ะดะพะฑะฐะฒะปัะตั ัะพะบะตะฝ ะฒ Authorization
```

### ะััะพะด:
```
1. ะะพะปัะทะพะฒะฐัะตะปั ะฝะฐะถะธะผะฐะตั "Logout"
2. ะคัะพะฝัะตะฝะด ัะดะฐะปัะตั ัะพะบะตะฝ ะธ username ะธะท localStorage
3. store.user = null, store.token = null
4. ะะพะปัะทะพะฒะฐัะตะปั ะฟะตัะตะฝะฐะฟัะฐะฒะปัะตััั ะฝะฐ /auth
```

---

## ๐ฑ ะะปั ัะตะปะตัะพะฝะฐ

### ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน:
```bash
pip install flask flask-cors shield-auth pyjwt bcrypt
```

### ะะฐะฟััะบ ะฑะตะบะตะฝะดะฐ:
```bash
python simple_backend.py
```

### ะะฐะฟััะบ ััะฝะฝะตะปั (ะฒ ะพัะดะตะปัะฝะพะผ ัะตัะผะธะฝะฐะปะต):
```bash
cloudflared tunnel --url http://localhost:8000
```

### ะะฑะฝะพะฒะธัั API_URL ะฝะฐ GitHub Pages:
```javascript
// js/api.js
export const API_URL = 'https://xxx.trycloudflare.com';
```

---

## ๐ ะัะปะฐะดะบะฐ

**ะัะปะธ ะฟะพะปัะทะพะฒะฐัะตะปั ะฝะต ะทะฐะฟะพะผะธะฝะฐะตััั:**
1. ะัะพะฒะตัั DevTools โ Application โ Local Storage
2. ะะพะปะถะฝั ะฑััั ะบะปััะธ: `auth_user`, `auth_token`
3. ะัะปะธ ะธั ะฝะตั - ัะพะบะตะฝ ะฝะต ัะพััะฐะฝะธะปัั ะฟัะธ ะปะพะณะธะฝะต

**ะัะปะธ ะฟัะพัะธะปั ะฝะต ะทะฐะณััะถะฐะตััั:**
1. ะัะพะฒะตัั DevTools โ Network โ /api/profile
2. ะะพะปะถะตะฝ ะฑััั ะทะฐะณะพะปะพะฒะพะบ: `Authorization: Bearer eyJ...`
3. ะัะปะธ ะตะณะพ ะฝะตั - `getToken()` ะฒะพะทะฒัะฐัะฐะตั null

**ะัะปะธ ัะพะบะตะฝ ัะบัะฐะดะตะฝ:**
1. ะัะตะผั ะถะธะทะฝะธ ัะพะบะตะฝะฐ: 7 ะดะฝะตะน
2. ะะพัะพะผ ะฝัะถะฝะพ ะปะพะณะธะฝะธัััั ะทะฐะฝะพะฒะพ
3. ะัะธ logout ัะพะบะตะฝ ัะดะฐะปัะตััั ะธะท localStorage

